const request = require("supertest");
const app = require("../server");

describe("POST /scan", () => {
    it("should detect an open redirect vulnerability", async () => {
        const res = await request(app)
            .post("/scan")
            .send({ url: "http://example.com/example?redirect=http://malicious.com" });
        expect(res.text).toContain("Found");
    });

    it("should not detect an open redirect vulnerability", async () => {
        const res = await request(app)
            .post("/scan")
            .send({ url: "http://example.com/safe" });
        expect(res.text).toContain("Not Found");
    });
});

